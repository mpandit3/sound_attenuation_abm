file_list <- as.list(list.files("Hollis_weather_2018"))
i = file_list[1]
i
w <- read.table(paste0("Weather_data/",i), skip=2, header=T, row.names = NULL)
w$filename = i  #add filename to data frame
w$year = as.numeric(substr(i,start = 1, stop = 4)) #add year to data frame
w$month = as.numeric(substr(i,start = 5, stop = 6))  #add month to data frame
w$day = as.numeric(substr(i,start = 7, stop = 8))  #add day of month to data frame
w <- read.table(paste0("Hollis_weather_2018/",i), skip=2, header=T, row.names = NULL)
w$filename = i  #add filename to data frame
w$year = as.numeric(substr(i,start = 1, stop = 4)) #add year to data frame
w$month = as.numeric(substr(i,start = 5, stop = 6))  #add month to data frame
w$day = as.numeric(substr(i,start = 7, stop = 8))  #add day of month to data frame
w$YMD = as.POSIXct(paste(w$year,w$month,w$day, sep ="-"), tz = "UTC")
w$DT = as.POSIXct(paste0(w$year,"-",w$month,"-",w$day," 00:00:00"), tz = "UTC") + w$TIME*60
sr1 <- getSunlightTimes(date = as_date(w$YMD[1]), lat = lat, lon = lon, tz = "UTC", keep = c("sunrise"))
sr2 <- getSunlightTimes(date = as_date(w$YMD[1]-86400), lat = lat, lon = lon, tz = "UTC", keep = c("sunrise"))
library(suncalc)
library(geonames)
library(lubridate)
library(suncalc)
library(geonames)
library(lubridate)
#Provide location latitude and longitude
lat = 36.69 #Hollis
lon = -99.91 #Hollis
w <- read.table(paste0("Hollis_weather_2018/",i), skip=2, header=T, row.names = NULL)
w$filename = i  #add filename to data frame
w$year = as.numeric(substr(i,start = 1, stop = 4)) #add year to data frame
w$month = as.numeric(substr(i,start = 5, stop = 6))  #add month to data frame
w$day = as.numeric(substr(i,start = 7, stop = 8))  #add day of month to data frame
w$YMD = as.POSIXct(paste(w$year,w$month,w$day, sep ="-"), tz = "UTC")
w$DT = as.POSIXct(paste0(w$year,"-",w$month,"-",w$day," 00:00:00"), tz = "UTC") + w$TIME*60
sr1 <- getSunlightTimes(date = as_date(w$YMD[1]), lat = lat, lon = lon, tz = "UTC", keep = c("sunrise"))
sr2 <- getSunlightTimes(date = as_date(w$YMD[1]-86400), lat = lat, lon = lon, tz = "UTC", keep = c("sunrise"))
sr1 <- sr1$sunrise
sr1 <- getSunlightTimes(date = as_date(w$YMD[1]), lat = lat, lon = lon, tz = "UTC", keep = c("sunrise"))
sr2 <- getSunlightTimes(date = as_date(w$YMD[1]-86400), lat = lat, lon = lon, tz = "UTC", keep = c("sunrise"))
sr1 <- sr1$sunrise
sr2 <- sr2$sunrise
w$MAS <- ifelse(w$DT<sr1, difftime(w$DT, sr2, units = "mins"), difftime(w$DT, sr1, units = "mins"))
w$MAS <- round(w$MAS, 0)
View(w)
#Compile weather data
library(suncalc)
library(geonames)
library(lubridate)
#Provide location latitude and longitude
lat = 36.69 #Hollis
lon = -99.91 #Hollis
file_list <- as.list(list.files("Hollis_weather_2018"))
for(i in file_list){
w <- read.table(paste0("Hollis_weather_2018/",i), skip=2, header=T, row.names = NULL)
w$filename = i  #add filename to data frame
w$year = as.numeric(substr(i,start = 1, stop = 4)) #add year to data frame
w$month = as.numeric(substr(i,start = 5, stop = 6))  #add month to data frame
w$day = as.numeric(substr(i,start = 7, stop = 8))  #add day of month to data frame
w$YMD = as.POSIXct(paste(w$year,w$month,w$day, sep ="-"), tz = "UTC")
w$DT = as.POSIXct(paste0(w$year,"-",w$month,"-",w$day," 00:00:00"), tz = "UTC") + w$TIME*60
sr1 <- getSunlightTimes(date = as_date(w$YMD[1]), lat = lat, lon = lon, tz = "UTC", keep = c("sunrise"))
sr2 <- getSunlightTimes(date = as_date(w$YMD[1]-86400), lat = lat, lon = lon, tz = "UTC", keep = c("sunrise"))
sr1 <- sr1$sunrise
sr2 <- sr2$sunrise
w$MAS <- ifelse(w$DT<sr1, difftime(w$DT, sr2, units = "mins"), difftime(w$DT, sr1, units = "mins"))
w$MAS <- round(w$MAS, 0)
if(as.character(i) == as.character(file_list[1])) {
wd <- w
} else {
wd <- rbind(wd,w)
}
print(i)
}
# rain <- wd[wd$RAIN>0 & wd$TIME != 0,]
# raindays <- unique(rain$YMD)
# wd <- wd[!wd$YMD %in% raindays,]
#wd <- wd[wd$MAS<6*60,] #subset to sunrise data only
plot(wd$MAS,wd$TAIR)
plot(wd$MAS,wd$RELH)
View(wd)
#Compile weather data
library(suncalc)
library(geonames)
library(lubridate)
#Provide location latitude and longitude
lat = 36.69 #Hollis
lon = -99.91 #Hollis
file_list <- as.list(list.files("Hollis_weather_2018"))
for(i in file_list){
w <- read.table(paste0("Hollis_weather_2018/",i), skip=2, header=T, row.names = NULL)
w$filename = i  #add filename to data frame
w$year = as.numeric(substr(i,start = 1, stop = 4)) #add year to data frame
w$month = as.numeric(substr(i,start = 5, stop = 6))  #add month to data frame
w$day = as.numeric(substr(i,start = 7, stop = 8))  #add day of month to data frame
w$YMD = as.POSIXct(paste(w$year,w$month,w$day, sep ="-"), tz = "UTC")
w$DT = as.POSIXct(paste0(w$year,"-",w$month,"-",w$day," 00:00:00"), tz = "UTC") + w$TIME*60
sr1 <- getSunlightTimes(date = as_date(w$YMD[1]), lat = lat, lon = lon, tz = "UTC", keep = c("sunrise"))
sr2 <- getSunlightTimes(date = as_date(w$YMD[1]-86400), lat = lat, lon = lon, tz = "UTC", keep = c("sunrise"))
sr1 <- sr1$sunrise
sr2 <- sr2$sunrise
w$MAS <- ifelse(w$DT<sr1, difftime(w$DT, sr2, units = "mins"), difftime(w$DT, sr1, units = "mins"))
w$MAS <- round(w$MAS, 0)
if(as.character(i) == as.character(file_list[1])) {
wd <- w
} else {
wd <- rbind(wd,w)
}
print(i)
}
# rain <- wd[wd$RAIN>0 & wd$TIME != 0,]
# raindays <- unique(rain$YMD)
# wd <- wd[!wd$YMD %in% raindays,]
#wd <- wd[wd$MAS<6*60,] #subset to sunrise data only
wdsum <- data.frame(bin1 = wd$MAS, bin2 = wd$MAS+5,
TAIR = wd$TAIR, RELH = wd$RELH,
PRES = wd$PRES)
plot(wdsum$bin1,wdsum$TAIR)
plot(wdsum$bin1,wdsum$RELH)
plot(wdsum$bin1,wdsum$PRES)
View(wdsum)
#Compile weather data
library(suncalc)
library(geonames)
library(lubridate)
#Provide location latitude and longitude
lat = 36.69 #Hollis
lon = -99.91 #Hollis
file_list <- as.list(list.files("Hollis_weather_2018"))
for(i in file_list){
w <- read.table(paste0("Hollis_weather_2018/",i), skip=2, header=T, row.names = NULL)
w$filename = i  #add filename to data frame
w$year = as.numeric(substr(i,start = 1, stop = 4)) #add year to data frame
w$month = as.numeric(substr(i,start = 5, stop = 6))  #add month to data frame
w$day = as.numeric(substr(i,start = 7, stop = 8))  #add day of month to data frame
w$YMD = as.POSIXct(paste(w$year,w$month,w$day, sep ="-"), tz = "UTC")
w$DT = as.POSIXct(paste0(w$year,"-",w$month,"-",w$day," 00:00:00"), tz = "UTC") + w$TIME*60
sr1 <- getSunlightTimes(date = as_date(w$YMD[1]), lat = lat, lon = lon, tz = "UTC", keep = c("sunrise"))
sr2 <- getSunlightTimes(date = as_date(w$YMD[1]-86400), lat = lat, lon = lon, tz = "UTC", keep = c("sunrise"))
sr1 <- sr1$sunrise
sr2 <- sr2$sunrise
w$MAS <- ifelse(w$DT<sr1, difftime(w$DT, sr2, units = "mins"), difftime(w$DT, sr1, units = "mins"))
w$MAS <- round(w$MAS, 0)
if(as.character(i) == as.character(file_list[1])) {
wd <- w
} else {
wd <- rbind(wd,w)
}
print(i)
}
# rain <- wd[wd$RAIN>0 & wd$TIME != 0,]
# raindays <- unique(rain$YMD)
# wd <- wd[!wd$YMD %in% raindays,]
#wd <- wd[wd$MAS<6*60,] #subset to sunrise data only
wdsum <- data.frame(bin1 = wd$MAS, bin2 = wd$MAS+5,
date = wd$YMD, TAIR = wd$TAIR,
RELH = wd
View(wdsum)
View(wdsum)
#Compile weather data
library(suncalc)
library(geonames)
library(lubridate)
#Provide location latitude and longitude
lat = 36.69 #Hollis
lon = -99.91 #Hollis
file_list <- as.list(list.files("Hollis_weather_2018"))
for(i in file_list){
w <- read.table(paste0("Hollis_weather_2018/",i), skip=2, header=T, row.names = NULL)
w$filename = i  #add filename to data frame
w$year = as.numeric(substr(i,start = 1, stop = 4)) #add year to data frame
w$month = as.numeric(substr(i,start = 5, stop = 6))  #add month to data frame
w$day = as.numeric(substr(i,start = 7, stop = 8))  #add day of month to data frame
w$YMD = as.POSIXct(paste(w$year,w$month,w$day, sep ="-"), tz = "UTC")
w$DT = as.POSIXct(paste0(w$year,"-",w$month,"-",w$day," 00:00:00"), tz = "UTC") + w$TIME*60
sr1 <- getSunlightTimes(date = as_date(w$YMD[1]), lat = lat, lon = lon, tz = "UTC", keep = c("sunrise"))
sr2 <- getSunlightTimes(date = as_date(w$YMD[1]-86400), lat = lat, lon = lon, tz = "UTC", keep = c("sunrise"))
sr1 <- sr1$sunrise
sr2 <- sr2$sunrise
w$MAS <- ifelse(w$DT<sr1, difftime(w$DT, sr2, units = "mins"), difftime(w$DT, sr1, units = "mins"))
w$MAS <- round(w$MAS, 0)
if(as.character(i) == as.character(file_list[1])) {
wd <- w
} else {
wd <- rbind(wd,w)
}
print(i)
}
# rain <- wd[wd$RAIN>0 & wd$TIME != 0,]
# raindays <- unique(rain$YMD)
# wd <- wd[!wd$YMD %in% raindays,]
#wd <- wd[wd$MAS<6*60,] #subset to sunrise data only
wdsum <- data.frame(bin1 = wd$MAS, bin2 = wd$MAS+5,
date = wd$YMD, TAIR = wd$TAIR,
RELH = wd$RELH, PRES = wd$PRES)
View(wdsum)
as_date("05/03/2018")
as_date("05-03-2018"))
as_date("05-03-2018")
May3 = which(wdsum$date == as.POSIXct("2018-05-03", tz = "UTC"))
May3
as.POSIXct("2018-05-03", tz = "UTC")
wdsum$date
class(wdsum$date)
which(wdsum$date == as.POSIXct("2018-06-03", tz = "UTC"))
May3 = which(wdsum$date == as.POSIXct("2018-06-03", tz = "UTC"))
May4 = which(wdsum$date == as.POSIXct("2018-06-04", tz = "UTC"))
May5 = which(wdsum$date == as.POSIXct("2018-06-05", tz = "UTC"))
May6 = which(wdsum$date == as.POSIXct("2018-06-06", tz = "UTC"))
May7 = which(wdsum$date == as.POSIXct("2018-06-07", tz = "UTC"))
May7
May6
plot(wdsum$bin1[May3,],wdsum$TAIR[May3,])
plot(wdsum$bin1[May3],wdsum$TAIR[May3])
plot(wdsum$bin1[May4],wdsum$TAIR[May4])
View(wdsum)
rep(min(wd$YMD):max(wd$YMD), each=1440/5)
library(nlme)
library(lme4)
library(dplyr)
library(lmerTest)
setwd("/cloud/project/data_clean/normal")
mdata1 = "/cloud/project/data_clean/normal/results_normal.Rdata"
mdata2 = "/cloud/project/data_clean/normal/completion_normal.Rdata"
load(mdata1)
load(mdata2)
data1 = Results_normal #loading Results data
data2 = completion_normal #loading Completion data
#Add treatment to the dataframe
data1$treatment = substr(data1$date, 1,4)
data2$treatment = substr(data2$date, 1,4)
View(data1)
View(data2)
data1_means  = data1 %>%
# group_by(data1$date) %>%
#group_by(data1$date) %>%
group_by(treatment, date, n) %>%
summarise(mean(SingCnt))
data1_means  = data1 %>%
# group_by(data1$date) %>%
#group_by(data1$date) %>%
group_by(treatment, date, N) %>%
summarise(mean(SingCnt))
View(data1_means)
data1_means  = data1 %>%
# group_by(data1$date) %>%
#group_by(data1$date) %>%
group_by(treatment, date, N) %>%
summarise(mean(SingCnt), n = n())
colnames(data1_means) = c("treatment", "date", "ind", "meanSingCnt", "n")
M1 = lm(SingCnt ~ treatment, data = data1)
summary(M1)
coefs <- data.frame(coef(summary(M1)))
coefs$p.z <- 2 * (1 - pnorm(abs(coefs$t.value)))
coefs
library(suncalc)
library(lubridate)
library(ggplot2)
library(okmesonet)
library(dplyr)
library(data.table)
library(rgeos)
library(sp)
library(spdep)
library(FNN)
library(plotrix)
library(ggplot2)
